<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
        <title>Dashboard</title>
        <meta http-equiv="content-type" content="text/html;charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="/common/ui/melange.css" media="screen" />
        <script type="text/javascript" src="/common/core/mootools.js"></script>
        <script type="text/javascript" src="/common/core/mootools-more.js" />
        <script type="text/javascript" src="/common/core/cream.js"></script>
        <script type="text/javascript" src="/common/ui/scroll/scroll.js" />
        <script type="text/javascript" src="/common/ui/chooser/chooser.js" />
        <style type="text/css">
            div.application {
                width: 80px;
                height: 65px;

                float: left;
                text-align: center;
                padding: 5px;
                opacity: 0.7;

            }
            div.application:hover{
                opacity: 1;
                background: rgba(255, 255, 255, .25);
                border-radius: 10px;
            }
            .name {
                font-weight: bold;
            }
        </style>
        <script type="text/javascript">
            function main(){
                widget.api.dashboard.get_all_apps(function(apps) {
                    for(i=0; i<apps.length; i++){
                        add_app(apps[i]);
                    };
                });
            }

            function add_app(app){
                app_wrapper = new Element('div', {
                    'class': 'application',
                    'id': app['cmd'],
                    'events': {
                        'click': function(e){
                            launch_app(this.id);
                        }
                    }
                });

                app_icon = new Element('img', {
                    'class': 'application',
                    'src': 'data:image/png;base64,' + app['icon']
                });

                app_name = new Element('div', {
                    'class': 'name',
                    'html': app['name']
                });

                app_wrapper.grab(app_icon);
                app_wrapper.grab(app_name);
                $('dashboard-all').grab(app_wrapper);
            }

            function launch_app(cmd){
                widget.api.dashboard.launch_app(cmd);

            }
        </script>
    </head>

    <body>
        <div class="widget" style="width: 410px;">
            <div class="background">
                <div class="chooser" id="mode">
                    <div class="option" id="all">
                        All
                    </div>
                    <div class="option" id="favourites">
                        Favourites
                    </div>
                </div>
                <div class="scroll" style="height: 300px;">
                    <div class="chooser-tabs" id="mode-tabs">
                        <div id="all-tab" class="tab">
                            <div id="dashboard-all">
                            </div>
                        </div>
                        <div id="favourites-tab" class="tab">
                            Here are the favs.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
