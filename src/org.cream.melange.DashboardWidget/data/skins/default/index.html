<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
        <title>Dashboard</title>
        <meta http-equiv="content-type" content="text/html;charset=utf-8" />
        <link rel="stylesheet" type="text/css" href="/common/ui/melange.css" media="screen" />
        <script type="text/javascript" src="/common/core/mootools.js"></script>
        <script type="text/javascript" src="/common/core/mootools-more.js"></script>
        <script type="text/javascript" src="/common/core/cream.js"></script>
        <script type="text/javascript" src="/common/ui/scroll/scroll.js"></script>

        <script type="text/javascript" src="/common/ui/spinner/spinner.js"></script>

        <script type="text/javascript" src="dashboard.js"></script>
        <script type="text/javascript" src="dashboard-dnd.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" media="screen" />

        <script type="text/javascript">
            function main(){
                var spinner = new Spinner($('spinner'));
                spinner.start();

                var timeout_id;
                widget.config.addEvent('field-value-changed', function(sender, field, value){
                    if(field != 'favorites'){
                        $clear(timeout_id);
                        spinner = new Spinner($('spinner'));
                        spinner.start();
                        timeout_id = update_dashboard.delay(1000);
                    }
                });

                $('remove').fade('hide');

                widget.api.addEvent('load-favorites', function(favs){
                    load_favorites(favs);
                });
                widget.api.addEvent('load-apps', function(apps){
                    if(spinner.interval_id != null){
                        spinner.stop();
                        $('spinner_overlay').fade('hide');
                    }
                    load_apps(apps);
                });
            }
        </script>

    </head>

    <body>
        <div class="widget" id="widget" style="width: 390px;">
            <div id="spinner_overlay">
                <div id="spinner_container">
                    <div id="spinner"></div>
                </div>
            </div>

            <div class="overlay" id="remove">
                <div style="width: 100%; margin-top: 80px;">
                    <center>
                        <img src="trash.png" /><br />
                        <span class="remove">
                            Drop here for removal!
                        </span>
                    </center>
                </div>
            </div>

            <div class="scroll" style="height: 320px;">
                <div id="dashboard">
                </div>
            </div>
            <div class="favorites" id="favorites">
            </div>
        </div>
    </body>
</html>
