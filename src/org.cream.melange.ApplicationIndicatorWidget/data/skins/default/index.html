<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 
    <head>
        <title>Application Indicators</title>
        <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    
        <script type="text/javascript" src="/common/core/mootools.js"></script>
        <script type="text/javascript" src="/common/core/melange.js"></script>

        <link rel="stylesheet" type="text/css" href="/theme/ui/melange.css" media="screen">
        <style type="text/css">
        .entry {
            float: left;
            border-radius: 5px;
            margin: 2px;
        }
        
        .widget, .background, #entry-container {
            padding: 0px;
            margin: 0px;
        }
        </style>

        <script language="javascript">
        function add_entry(data) {
            var entry = new Element('div');
            entry.set('id', data['id']);
            entry.set('class', 'entry');
            entry.inject($('entry-container'));
            
            var icon = new Element('img');
            icon.set('id', data['id'] + '-img');
            icon.set('src', data['icon']);
            icon.inject(entry);
            
            entry.addEvent('click', function() {
                widget.api.indicators.show_menu(this.get('id'));
            });
        }

        function main() {
            widget.api.indicators.get_entries(function(entries) {
                for(i=0; i < entries.length; i++){
                    var entry = entries[i];
                    add_entry(entry);
                }
            });
            widget.api.addEvent('entry-added', function(entry) {
                add_entry(entry);
            })

            widget.api.addEvent('entry-removed', function(data) {
                entry = $(data['id']);
                entry.dispose();
            })

            widget.api.addEvent('entry-updated', function(data) {
                icon = $(data['id'] + '-img');
                icon.set('src', data['icon']);
            })
        }
        </script>
    </head>
 
    <body>
        <div class="widget" style="min-width: 120px;">
            <div class="background">
                <div id="entry-container">
                </div>
                <div style="clear: both;"></div>
            </div>
        </div>
    </body>
 
</html>
